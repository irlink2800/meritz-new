



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the DexGuard tool">
      
      
      
        <meta name="author" content="Guardsquare">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="img/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Encryption Plugins - DexGuard</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7C&display=fallback">
        <style>body,input{font-family:"","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="css/extra.css">
    
      <link rel="stylesheet" href="css/extra2.css">
    
      <link rel="stylesheet" href="css/tabs.css">
    
    
      
    
    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NMXSB9');</script>
<!-- End Google Tag Manager -->


  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#dependencies" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMXSB9"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
   
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="DexGuard" aria-label="DexGuard" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="img/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              DexGuard
            </span>
            <span class="md-header-nav__topic">
              
                Encryption Plugins
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    

    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="DexGuard" class="md-nav__button md-logo">
      
        <img alt="logo" src="img/logo.png" width="48" height="48">
      
    </a>
    DexGuard
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="quickstart.html" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="introduction.html" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="setup/standalone.html" title="DexGuard" class="md-nav__link">
      DexGuard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/upgrading.html" title="Upgrading" class="md-nav__link">
      Upgrading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/gradle-plugin.html" title="Gradle Plugin" class="md-nav__link">
      Gradle Plugin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/repository.html" title="Maven repository" class="md-nav__link">
      Maven repository
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/espresso.html" title="Espresso" class="md-nav__link">
      Espresso
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/cordovaplugin.html" title="Cordova Plugin" class="md-nav__link">
      Cordova Plugin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="configuration.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="usage.html" title="Reference Guide" class="md-nav__link">
      Reference Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="defaultconfigurations.html" title="Default Configs" class="md-nav__link">
      Default Configs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="annotations.html" title="Annotations" class="md-nav__link">
      Annotations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Features
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="protection.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="rasp.html" title="RASP" class="md-nav__link">
      RASP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Languages & Platforms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Languages & Platforms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="java.html" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="kotlin.html" title="Kotlin" class="md-nav__link">
      Kotlin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="javascript.html" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      ThreatCast
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        ThreatCast
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="threatcast.html" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      In Depth
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        In Depth
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="protectionreport.html" title="Protection Report" class="md-nav__link">
      Protection Report
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="examples.html" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="refcard.html" title="Reference Card" class="md-nav__link">
      Reference Card
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="optimizations.html" title="Optimizations" class="md-nav__link">
      Optimizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="attributes.html" title="Attributes" class="md-nav__link">
      Attributes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="loggingremoval.html" title="Logging Removal" class="md-nav__link">
      Logging Removal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="verification.html" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="runtime.html" title="Runtime Library" class="md-nav__link">
      Runtime Library
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Encryption Plugins
      </label>
    
    <a href="plugins.html" title="Encryption Plugins" class="md-nav__link md-nav__link--active">
      Encryption Plugins
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies for custom encryption plugins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementing a custom encryption plugin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Applying the custom encryption plugin to your application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameterizing-the-encryption" class="md-nav__link">
    Parameterizing the encryption
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#android-resources" class="md-nav__link">
    Android Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assets-and-native-libraries" class="md-nav__link">
    Assets and native libraries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    Strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="codepush.html" title="Code Push" class="md-nav__link">
      Code Push
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Addons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Addons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="addons_overview.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ndk.html" title="NDK" class="md-nav__link">
      NDK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="whitebox.html" title="Whitebox Cryptography" class="md-nav__link">
      Whitebox Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="fingerprinting.html" title="Device Fingerprinting" class="md-nav__link">
      Device Fingerprinting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="securekeyboard.html" title="Secure Keyboard" class="md-nav__link">
      Secure Keyboard
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="tools/androidstudio.html" title="Android Studio Plugin" class="md-nav__link">
      Android Studio Plugin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tools/libraryrulesgenerator.html" title="Library Rules Generator" class="md-nav__link">
      Library Rules Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tools/retrace.html" title="ReTrace" class="md-nav__link">
      ReTrace
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Troubleshooting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Troubleshooting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="troubleshooting.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reportingissues.html" title="Reporting Issues" class="md-nav__link">
      Reporting Issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="releasenotes.html" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="license.html" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies for custom encryption plugins
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation" class="md-nav__link">
    Implementing a custom encryption plugin
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Applying the custom encryption plugin to your application
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameterizing-the-encryption" class="md-nav__link">
    Parameterizing the encryption
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#android-resources" class="md-nav__link">
    Android Resources
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assets-and-native-libraries" class="md-nav__link">
    Assets and native libraries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#strings" class="md-nav__link">
    Strings
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Encryption Plugins</h1>
                
                <p>DexGuard can encrypt sensitive resources in your application with
polymorphic code. With DexGuard's plugin framework, you can replace the
standard encryption and decryption algorithms with your own.</p>
<p>With custom encryption algorithms, you can raise the bar for attackers
who try to reverse engineer and modify your applications. The greater
the variation in the obfuscation of your applications, the harder it
becomes for attackers and reverse engineering tools to recognize
patterns and decipher the encryption in obfuscated code.</p>
<p>You can write your own encryption algorithms for DexGuard's plugin
framework in Java, without the need to know Java bytecode or Dalvik
bytecode. There are three simple steps:</p>
<ol>
<li><a href="#implementation">Implement your own encryption plugin class</a>, based
    on the <a href="#dependencies">DexGuard API</a>.</li>
<li>Compile your plugin code and package it in a jar file.</li>
<li><a href="#configuration">Apply the plugin in your DexGuard build</a>.</li>
</ol>
<h2 id="dependencies">Dependencies for custom encryption plugins<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<p>DexGuard comes with a Java-based API for the development of custom
DexGuard encryption algorithms. The DexGuard API classes require at
least a Java 1.6 compiler.</p>
<p>You can find the DexGuard plugin API in the DexGuard distribution at</p>
<div class="codehilite"><pre><span></span><code>lib/dexguard-api.jar
</code></pre></div>


<p>It is self-contained, and does not depend on any libraries, other than
the Java Standard Library. Notably, it does not depend on
<code>lib/dexguard.jar</code>.</p>
<p>You may use other libraries, such as cryptographic frameworks, in your
algorithm implementation. Note however that all classes used by your
decryption code will also end up in your obfuscated application, which
might run in another runtime environment (e.g., Android). If you should
use third-party libraries, also verify that their license allows
redistribution and modification of their code.</p>
<h2 id="implementation">Implementing a custom encryption plugin<a class="headerlink" href="#implementation" title="Permanent link">&para;</a></h2>
<p>DexGuard's plugin API provides an abstract encryption class for each
type of resource that can be encrypted:</p>
<table>
<thead>
<tr>
<th>Resource type</th>
<th>Plugin API abstract class</th>
</tr>
</thead>
<tbody>
<tr>
<td>String</td>
<td><code>com.guardsquare.dexguard.encryption.string.StringEncryptionPlugin</code></td>
</tr>
<tr>
<td>Native library</td>
<td><code>com.guardsquare.dexguard.encryption.nativelibrary.NativeLibraryEncryptionPlugin</code></td>
</tr>
<tr>
<td>Asset</td>
<td><code>com.guardsquare.dexguard.encryption.asset.AssetEncryptionPlugin</code></td>
</tr>
<tr>
<td>Android resource</td>
<td><code>com.guardsquare.dexguard.encryption.resource.ResourceEncryptionPlugin</code></td>
</tr>
</tbody>
</table>
<p>Each encryption class has an encryption and decryption method, taking
either an <code>InputStream</code>, <code>OutputStream</code>, a byte array or <code>String</code> as
input. You can implement a cryptographic algorithm for use with DexGuard
by extending the appropriate encryption class and implementing the
corresponding encrypt/decrypt methods. The <a href="plugins/index.html">DexGuard API
Javadoc</a> provides a detailed description of each of
the encryption classes.</p>
<p>The following is a simple example of an asset encryption plugin,
encrypting assets by applying an exclusive or operation on all bytes,
with a given constant:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleConstantXorAssetEncryptionPlugin</span>
<span class="kd">extends</span>      <span class="n">AssetEncryptionPlugin</span><span class="o">&lt;</span><span class="n">Void</span><span class="p">,</span> <span class="n">Void</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">byte</span> <span class="n">OBFUSCATION_CONSTANT</span> <span class="o">=</span> <span class="mi">76</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">OutputStream</span> <span class="nf">encryptAsset</span><span class="p">(</span><span class="n">OutputStream</span> <span class="n">outputStream</span><span class="p">,</span>
                                     <span class="n">Void</span>         <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                     <span class="n">Void</span>         <span class="n">encryptionKey</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">XorOutputStream</span><span class="p">(</span><span class="n">outputStream</span><span class="p">,</span> <span class="n">OBFUSCATION_CONSTANT</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">decryptAsset</span><span class="p">(</span><span class="n">InputStream</span> <span class="n">inputStream</span><span class="p">,</span>
                                    <span class="n">Void</span>        <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                    <span class="n">Void</span>        <span class="n">encryptionKey</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">XorInputStream</span><span class="p">(</span><span class="n">inputStream</span><span class="p">,</span> <span class="n">OBFUSCATION_CONSTANT</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>During the build process of your application, DexGuard will call the
<code>encrypt</code> method of your plugin to encrypt your application's resources,
before packing them into the output jar or apk. The <code>decrypt</code> method of
your plugin will be obfuscated and copied into the application code, in
the places where encrypted resources are loaded. Therefore, the
decryption code needs to be compatible with the target environment of
the application (e.g. Android).</p>
<h2 id="configuration">Applying the custom encryption plugin to your application<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<p>Once your encryption implementation is finished, you can compile it and
bundle it in a jar file. You can then instruct DexGuard to use it, by
adding the following line to your DexGuard configuration:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">-pluginjars </span><span class="err">myCrypthographicPlugin.jar</span>
</code></pre></div>

<p>Then apply encryption to the various resource types as usual:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">-encryptstrings</span> <span class="o">[</span><span class="kt">string_filter</span><span class="o">]</span>
<span class="nb">-encryptnativelibraries </span><span class="err">[file_filter]</span>
<span class="nb">-encryptassetfiles </span><span class="err">[file_filter]</span>
<span class="nb">-encryptresourcefiles   </span><span class="err">[file_filter]</span>
</code></pre></div>

<p>DexGuard automatically picks up the plugin implementations in your
plugin jar. If it finds multiple implementations, it will randomly
choose an algorithm for each resource. The more implementations you can
provide, the harder it will generally become to reverse engineer
obfuscated applications. For Android resources (files in res/XXX), only
one algorithm is supported per application.</p>
<p>If, for some resource type, DexGuard doesn't find a plugin
implementation in your jar, it will fall back to the default built-in
algorithms.</p>
<h2 id="parameterizing-the-encryption">Parameterizing the encryption<a class="headerlink" href="#parameterizing-the-encryption" title="Permanent link">&para;</a></h2>
<p>To increase the strength of your encryption, you can add variation to
the encryption, by parameterizing the algorithm with encryption keys.
The approach is slightly different depending on the resource to be
encrypted.</p>
<h3 id="android-resources">Android Resources<a class="headerlink" href="#android-resources" title="Permanent link">&para;</a></h3>
<p>For Android resources, the <code>encryptResource()</code> and <code>decryptResource()</code>
methods take resource-specific parameters (resource ID, file name, file
size) that can be used to parameterize the algorithm. As a very simple
example, you could use the resource ID as a cryptographic key for our
XOR-based encryption algorithm:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">encryptResource</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span><span class="p">,</span>
                              <span class="kt">int</span>    <span class="n">resourceId</span><span class="p">,</span>
                              <span class="n">String</span> <span class="n">fileName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">XorUtil</span><span class="p">.</span><span class="na">xor</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="n">resourceId</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kt">byte</span><span class="o">[]</span> <span class="nf">decryptResource</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptedBytes</span><span class="p">,</span>
                              <span class="kt">int</span>    <span class="n">resourceId</span><span class="p">,</span>
                              <span class="n">String</span> <span class="n">fileName</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">XorUtil</span><span class="p">.</span><span class="na">xor</span><span class="p">(</span><span class="n">encryptedBytes</span><span class="p">,</span> <span class="n">resourceId</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h3 id="assets-and-native-libraries">Assets and native libraries<a class="headerlink" href="#assets-and-native-libraries" title="Permanent link">&para;</a></h3>
<p>Encryption keys are modeled using Java classes. The contents of an
encryption key class are specific to the algorithm it is used with; it
can range from a simple byte to a complex combination of primitives,
arrays and other data. Note that there are some restrictions on its
contents; please refer to the Javadoc of the encryption plugin classes
for more details.</p>
<p>For assets and native libraries, there are two types of encryption keys:</p>
<ul>
<li>Shared encryption keys: a key that is shared by a group of
  resources. DexGuard automatically groups resources for key sharing,
  based on internal heuristics.</li>
<li>Resource-specific encryption keys: a key that is specific to one
  individual asset or native library.</li>
</ul>
<p>Encryption key classes are linked to an encryption plugin via two
generic type parameters of the plugin class. Key instances are created
and initialized for a given (set of) resource(s) in the
<code>create*EncryptionKey</code> methods of the plugin. These methods receive
additional contextual information about the encrypted resource(s), that
can be used to derive a value for the encryption key.</p>
<p>In the following example, the encryption keys for a simple asset plugin
are defined by a simple byte; their value is derived from the group seed
and the asset file size:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleXorAssetEncryptionPlugin</span>
<span class="kd">implements</span>   <span class="n">AssetEncryptionPlugin</span><span class="o">&lt;</span><span class="n">SharedEncryptionKey</span><span class="p">,</span> <span class="n">EncryptionKey</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">public</span> <span class="n">SharedEncryptionKey</span> <span class="nf">createAssetSharedEncryptionKey</span><span class="p">(</span><span class="kt">long</span> <span class="n">groupSeed</span><span class="p">,</span>
                                                              <span class="n">Set</span>  <span class="n">assetFileNames</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">SharedEncryptionKey</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SharedEncryptionKey</span><span class="p">();</span>
        <span class="n">key</span><span class="p">.</span><span class="na">parameter</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="n">groupSeed</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">key</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">EncryptionKey</span> <span class="nf">createAssetEncryptionKey</span><span class="p">(</span><span class="n">SharedEncryptionKey</span> <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                                  <span class="kt">long</span>                <span class="n">seed</span><span class="p">,</span>
                                                  <span class="n">String</span>              <span class="n">assetFileName</span><span class="p">,</span>
                                                  <span class="kt">long</span>                <span class="n">approximateFileSize</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">EncryptionKey</span> <span class="n">key</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EncryptionKey</span><span class="p">();</span>
        <span class="n">key</span><span class="p">.</span><span class="na">parameter</span> <span class="o">=</span> <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="n">assetFileSize</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">key</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">SharedEncryptionKey</span> <span class="p">{</span>
        <span class="kd">public</span> <span class="kt">byte</span> <span class="n">parameter</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">EncryptionKey</span> <span class="p">{</span>
        <span class="kd">public</span> <span class="kt">byte</span> <span class="n">parameter</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The encryption keys are passed as parameters to the <code>encrypt*</code> and
<code>decrypt*</code> methods, that can use them to properly configure the
encryption/decryption algorithm.</p>
<p>Although not required, you should preferably use both encryption keys to
initialize the cryptographic algorithm, for maximal security.</p>
<p>Continuing with the previous example, we can now combine both bytes of
the shared and individual asset encryption key in the encrypt and
decrypt method, and use the resulting value in a XOR operation:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="n">OutputStream</span> <span class="nf">encryptAsset</span><span class="p">(</span><span class="n">OutputStream</span>        <span class="n">outputStream</span><span class="p">,</span>
                                 <span class="n">SharedEncryptionKey</span> <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                 <span class="n">EncryptionKey</span>       <span class="n">encryptionKey</span> <span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
    <span class="kt">byte</span> <span class="n">combinedXorValue</span> <span class="o">=</span>
        <span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">sharedEncryptionKey</span><span class="p">.</span><span class="na">parameter</span> <span class="o">^</span> <span class="n">encryptionKey</span><span class="p">.</span><span class="na">parameter</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="n">XorOutputStream</span><span class="p">(</span><span class="n">outputStream</span><span class="p">,</span> <span class="n">combinedXorValue</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="n">InputStream</span> <span class="nf">decryptAsset</span><span class="p">(</span><span class="n">InputStream</span>         <span class="n">inputStream</span><span class="p">,</span>
                                <span class="n">SharedEncryptionKey</span> <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                <span class="n">EncryptionKey</span>       <span class="n">encryptionKey</span> <span class="p">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="p">{</span>
    <span class="kt">byte</span> <span class="n">combinedXorValue</span> <span class="o">=</span>
        <span class="p">(</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="n">sharedEncryptionKey</span><span class="p">.</span><span class="na">parameter</span> <span class="o">^</span> <span class="n">encryptionKey</span><span class="p">.</span><span class="na">parameter</span><span class="p">);</span>

    <span class="k">return</span> <span class="k">new</span> <span class="n">XorInputStream</span><span class="p">(</span><span class="n">inputStream</span><span class="p">,</span> <span class="n">combinedXorValue</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<p>During the build process, DexGuard will generate the encryption keys by
calling the key creation methods for each resource, and pass these keys
to the <code>encrypt</code> method, together with the data to be encrypted. At the
same time, it will store all encryption keys in the obfuscated
application, and make sure the <code>decrypt</code> method, within the application,
gets called with the correct encryption keys for each encrypted
resource.</p>
<h3 id="strings">Strings<a class="headerlink" href="#strings" title="Permanent link">&para;</a></h3>
<p>For Strings, there is no distinction between the individual encryption
key and the encrypted data. For a given String and shared encryption
key, the encryption algorithm generates a single output, the encrypted
string data. The contents of the encrypted data can be chosen freely,
within the limits of the framework â€” see Limitations.</p>
<p>The decryption method receives the shared encryption key, together with
the encrypted string data, and decrypts it back to the original String.</p>
<p>The following snippet shows a simple example of a string encryption that
XORs the character data of the String:</p>
<div class="codehilite"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SimpleStringEncryptionPlugin</span>
<span class="kd">extends</span>      <span class="n">StringEncryptionPlugin</span><span class="o">&lt;</span><span class="n">Void</span><span class="p">,</span> <span class="n">SimpleStringEncryptionPlugin</span><span class="p">.</span><span class="na">EncryptedString</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">char</span> <span class="n">OBFUSCATION_CONSTANT</span> <span class="o">=</span> <span class="mi">76</span><span class="p">;</span>

    <span class="kd">public</span> <span class="n">EncryptedString</span> <span class="nf">encryptString</span><span class="p">(</span><span class="n">Void</span>   <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                         <span class="kt">long</span>   <span class="n">stringSeed</span><span class="p">,</span>
                                         <span class="n">String</span> <span class="n">string</span>         <span class="p">)</span> <span class="p">{</span>
        <span class="n">EncryptedString</span> <span class="n">encryptedString</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EncryptedString</span><span class="p">();</span>
        <span class="n">encryptedString</span><span class="p">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">XorUtil</span><span class="p">.</span><span class="na">xor</span><span class="p">(</span> <span class="n">string</span><span class="p">.</span><span class="na">toCharArray</span><span class="p">(),</span> <span class="n">OBFUSCATION_CONSTANT</span><span class="p">);</span>
        <span class="k">return</span> <span class="n">encryptedString</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">decryptString</span><span class="p">(</span><span class="n">Void</span>            <span class="n">sharedEncryptionKey</span><span class="p">,</span>
                                <span class="n">EncryptedString</span> <span class="n">encryptedString</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="p">(</span><span class="n">XorUtil</span><span class="p">.</span><span class="na">xor</span><span class="p">(</span><span class="n">encryptedString</span><span class="p">.</span><span class="na">data</span><span class="p">,</span> <span class="n">OBFUSCATION_CONSTANT</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">EncryptedString</span> <span class="p">{</span>
        <span class="kt">char</span><span class="o">[]</span> <span class="n">data</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h2>
<p>Some restrictions apply on the implementations of encryption plugin and
encryption key classes. Please refer to the <a href="plugins/index.html">DexGuard API
Javadoc</a> for further details.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="runtime.html" title="Runtime Library" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Runtime Library
              </span>
            </div>
          </a>
        
        
          <a href="codepush.html" title="Code Push" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Code Push
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Guardsquare
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="assets/fonts/font-awesome.css">
    
      <a href="https://twitter.com/guardsquare" target="_blank" rel="noopener" title="twitter" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/guardsquare-nv" target="_blank" rel="noopener" title="linkedin" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://www.facebook.com/guardsquare" target="_blank" rel="noopener" title="facebook" class="md-footer-social__link fa fa-facebook"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>