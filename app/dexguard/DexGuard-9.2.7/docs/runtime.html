



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for the DexGuard tool">
      
      
      
        <meta name="author" content="Guardsquare">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="img/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.3">
    
    
      
        <title>Runtime Library - DexGuard</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=:300,400,400i,700%7C&display=fallback">
        <style>body,input{font-family:"","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="css/extra.css">
    
      <link rel="stylesheet" href="css/extra2.css">
    
      <link rel="stylesheet" href="css/tabs.css">
    
    
      
    
    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NMXSB9');</script>
<!-- End Google Tag Manager -->


  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#runtime-library" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMXSB9"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
   
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="DexGuard" aria-label="DexGuard" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="img/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              DexGuard
            </span>
            <span class="md-header-nav__topic">
              
                Runtime Library
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    

    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="DexGuard" class="md-nav__button md-logo">
      
        <img alt="logo" src="img/logo.png" width="48" height="48">
      
    </a>
    DexGuard
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="quickstart.html" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="introduction.html" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Setup
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Setup
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="setup/standalone.html" title="DexGuard" class="md-nav__link">
      DexGuard
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/upgrading.html" title="Upgrading" class="md-nav__link">
      Upgrading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/gradle-plugin.html" title="Gradle Plugin" class="md-nav__link">
      Gradle Plugin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/repository.html" title="Maven repository" class="md-nav__link">
      Maven repository
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/espresso.html" title="Espresso" class="md-nav__link">
      Espresso
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="setup/cordovaplugin.html" title="Cordova Plugin" class="md-nav__link">
      Cordova Plugin
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Configuration
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Configuration
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="configuration.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="usage.html" title="Reference Guide" class="md-nav__link">
      Reference Guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="defaultconfigurations.html" title="Default Configs" class="md-nav__link">
      Default Configs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="annotations.html" title="Annotations" class="md-nav__link">
      Annotations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Features
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="protection.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="rasp.html" title="RASP" class="md-nav__link">
      RASP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Languages & Platforms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Languages & Platforms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="java.html" title="Java" class="md-nav__link">
      Java
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="kotlin.html" title="Kotlin" class="md-nav__link">
      Kotlin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="javascript.html" title="JavaScript" class="md-nav__link">
      JavaScript
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      ThreatCast
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        ThreatCast
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="threatcast.html" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9" checked>
    
    <label class="md-nav__link" for="nav-9">
      In Depth
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        In Depth
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="protectionreport.html" title="Protection Report" class="md-nav__link">
      Protection Report
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="examples.html" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="refcard.html" title="Reference Card" class="md-nav__link">
      Reference Card
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="optimizations.html" title="Optimizations" class="md-nav__link">
      Optimizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="attributes.html" title="Attributes" class="md-nav__link">
      Attributes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="loggingremoval.html" title="Logging Removal" class="md-nav__link">
      Logging Removal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="verification.html" title="Verification" class="md-nav__link">
      Verification
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Runtime Library
      </label>
    
    <a href="runtime.html" title="Runtime Library" class="md-nav__link md-nav__link--active">
      Runtime Library
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies for the runtime library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tamper-detection" class="md-nav__link">
    Tamper detection
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-certificate-checker-with-google-play-signing" class="md-nav__link">
    Using the Certificate Checker with Google Play signing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-checks" class="md-nav__link">
    Environment checks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-detector" class="md-nav__link">
    Root detector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations_1" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-checks-performance" class="md-nav__link">
    Environment Checks Performance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugger-blocking" class="md-nav__link">
    Debugger blocking
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webview-asset-encryption" class="md-nav__link">
    Asset encryption for WebView clients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssl-pinning" class="md-nav__link">
    SSL pinning
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="plugins.html" title="Encryption Plugins" class="md-nav__link">
      Encryption Plugins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="codepush.html" title="Code Push" class="md-nav__link">
      Code Push
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Addons
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Addons
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="addons_overview.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="ndk.html" title="NDK" class="md-nav__link">
      NDK
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="whitebox.html" title="Whitebox Cryptography" class="md-nav__link">
      Whitebox Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="fingerprinting.html" title="Device Fingerprinting" class="md-nav__link">
      Device Fingerprinting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="securekeyboard.html" title="Secure Keyboard" class="md-nav__link">
      Secure Keyboard
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="tools/androidstudio.html" title="Android Studio Plugin" class="md-nav__link">
      Android Studio Plugin
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tools/libraryrulesgenerator.html" title="Library Rules Generator" class="md-nav__link">
      Library Rules Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="tools/retrace.html" title="ReTrace" class="md-nav__link">
      ReTrace
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Troubleshooting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Troubleshooting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="troubleshooting.html" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="reportingissues.html" title="Reporting Issues" class="md-nav__link">
      Reporting Issues
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="releasenotes.html" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="license.html" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dependencies" class="md-nav__link">
    Dependencies for the runtime library
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tamper-detection" class="md-nav__link">
    Tamper detection
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-certificate-checker-with-google-play-signing" class="md-nav__link">
    Using the Certificate Checker with Google Play signing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-checks" class="md-nav__link">
    Environment checks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#root-detector" class="md-nav__link">
    Root detector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations_1" class="md-nav__link">
    Limitations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-checks-performance" class="md-nav__link">
    Environment Checks Performance
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#debugger-blocking" class="md-nav__link">
    Debugger blocking
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#webview-asset-encryption" class="md-nav__link">
    Asset encryption for WebView clients
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ssl-pinning" class="md-nav__link">
    SSL pinning
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="runtime-library">Runtime Library<a class="headerlink" href="#runtime-library" title="Permanent link">&para;</a></h1>
<p>DexGuard's runtime library provides the following functionality:</p>
<ul>
<li><a href="#tamper-detection">Tamper detection</a> for the application.</li>
<li><a href="#environment-checks">Environment checks</a> for the Android runtime.</li>
<li><a href="#webview-asset-encryption">Asset encryption</a> for Cordova and for WebView
  clients.</li>
<li><a href="#ssl-pinning">SSL pinning</a> for secure network communication.</li>
</ul>
<p>The sections below outline the general use of the different parts of the
runtime library. Please refer to the <a href="runtime/index.html">runtime Javadoc</a>
for more details.</p>
<h2 id="dependencies">Dependencies for the runtime library<a class="headerlink" href="#dependencies" title="Permanent link">&para;</a></h2>
<p>The runtime library is a stand-alone Android library which you can find
in the DexGuard distribution at</p>
<div class="codehilite"><pre><span></span><code>lib/dexguard-runtime.aar
</code></pre></div>

<p>or included from the secure maven repository:</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Groovy</label><div class="tabbed-content">
<div class="codehilite"><pre><span></span><code><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">implementation</span> <span class="s1">&#39;com.guardsquare:dexguard-runtime:9.2+&#39;</span>
<span class="o">}</span>
</code></pre></div>

</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">Kotlin</label><div class="tabbed-content">
<div class="codehilite"><pre><span></span><code><span class="n">dependencies</span> <span class="p">{</span>
    <span class="n">implementation</span><span class="p">(</span><span class="s">&quot;com.guardsquare:dexguard-runtime:9.2+&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</div>
</div>
<p>It is self-contained, and does not depend on any libraries, other than
the Java Standard Library. The AAR file must be added to your application
project in order to use the API.</p>
<h2 id="tamper-detection">Tamper detection<a class="headerlink" href="#tamper-detection" title="Permanent link">&para;</a></h2>
<p>The runtime library provides three detector classes that check whether the
application has been modified in some way (in package
<a href="runtime/com/guardsquare/dexguard/runtime/detection/package-summary.html">com.guardsquare.dexguard.runtime.detection</a>):</p>
<table>
<thead>
<tr>
<th>Detector</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>TamperDetector</td>
<td>Checks if the apk file has been modified.</td>
</tr>
<tr>
<td>CertificateChecker</td>
<td>Checks if the application has been signed with the build certificate.</td>
</tr>
<tr>
<td>FileChecker</td>
<td>Checks if one or more individual files have been modified.</td>
</tr>
</tbody>
</table>
<p>For example, you can use the <code>TamperDetector</code> to check the apk file:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">// We need a context for most methods.</span>
<span class="kd">final</span> <span class="n">Context</span> <span class="n">context</span> <span class="o">=</span> <span class="p">...;</span>

<span class="c1">// Expected return value. You can pick any number,</span>
<span class="c1">// to make the code less predictable.</span>
<span class="kd">final</span> <span class="kt">int</span> <span class="n">OK</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">// Let the DexGuard runtime library detect whether the apk has</span>
<span class="c1">// been modified or repackaged in any way.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">TamperDetector</span><span class="p">.</span><span class="na">checkApk</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">OK</span><span class="p">)</span> <span class="o">!=</span> <span class="n">OK</span><span class="p">)</span> <span class="p">{</span>
   <span class="c1">// The application has been modified.</span>
   <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>

<p>The check returns the value of the optional integer argument OK (default=0) if
the application is unchanged. You should implement a suitable reaction in case
the application has been modified, for example stop it or reduce its
functionality in a more subtle way.</p>
<p>The <code>FileChecker</code> can be used to check if individual files inside the apk have been
tampered with. This can be used if the application is modified after being processed
by DexGuard (e.g. to resign the application, see Limitations below):</p>
<div class="codehilite"><pre><span></span><code>    <span class="c1">// ...</span>

    <span class="kt">int</span> <span class="n">primaryDexChanged</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">FileChecker</span><span class="p">(</span><span class="n">context</span><span class="p">).</span><span class="na">checkFile</span><span class="p">(</span><span class="s">&quot;classes.dex&quot;</span><span class="p">,</span> <span class="n">OK</span><span class="p">);</span>

    <span class="c1">// Let the DexGuard runtime library detect whether the apk has</span>
    <span class="c1">// been modified or repackaged in any way.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">primaryDexChanged</span> <span class="o">!=</span> <span class="n">OK</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// The classes.dex file has been modified.</span>
       <span class="c1">// ...</span>
    <span class="p">}</span>
</code></pre></div>

<h3 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h3>
<p>The tamper detection is very reliable. However, some stores, including the
<a href="https://www.amazon.com/mobile-apps/">Amazon App Store</a> and the Google Play
Store when using the optional <a href="https://developer.android.com/studio/publish/app-signing.html#google-play-app-signing">Google Play App Signing</a>,
re-sign the application when you upload your app to the store. This will set
off the tamper detection, as the application will be modified and signed with
a different certificate than the one specified at build time. However, file-level tamper
detection is unaffected by the re-signing with certain exceptions, e.g., the <code>AndroidManifest.xml</code>
file which is modified during the re-signing.</p>
<h4 id="using-the-certificate-checker-with-google-play-signing">Using the Certificate Checker with Google Play signing<a class="headerlink" href="#using-the-certificate-checker-with-google-play-signing" title="Permanent link">&para;</a></h4>
<p>When using <a href="https://support.google.com/googleplay/android-developer/answer/7384423?hl=en">app signing by Google Play</a>, Google manages and protects your app's signing key for you and signs your APKs on your behalf. In this case DexGuard does not know which signing key will be used and thus does not know which certificate hash should be used to detect resigning of your app.</p>
<p>To circumvent this issue, our certificate checker can take the expected certificate hash as <a href="https://www.guardsquare.com/en/manual/dexguard/stable/runtime/com/guardsquare/dexguard/runtime/detection/CertificateChecker.html#checkCertificate-android.content.Context-java.lang.String-">an argument</a> when called.</p>
<p>You can find the certificate hash of the signing key used by Google on your Google Play console under the "App Signing" section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The use of MD5 hashes has been deprecated. Use SHA-256 hashes for the best security guarantees.</p>
</div>
<h2 id="environment-checks">Environment checks<a class="headerlink" href="#environment-checks" title="Permanent link">&para;</a></h2>
<p>The runtime library also provides detector classes that check whether the
application is currently running in a specific environment (in package
<a href="runtime/com/guardsquare/dexguard/runtime/detection/package-summary.html">com.guardsquare.dexguard.runtime.detection</a>):</p>
<table>
<thead>
<tr>
<th>Detector</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>HookDetector</td>
<td>Checks if the application is being hooked with a specialized framework like Xposed or Substrate.</td>
</tr>
<tr>
<td>RootDetector</td>
<td>Checks if the application is running on a rooted device.</td>
</tr>
<tr>
<td>DebugDetector</td>
<td>Checks if the application can be debugged or if it is being debugged.</td>
</tr>
<tr>
<td>EmulatorDetector</td>
<td>Checks if the application is running on an emulator.</td>
</tr>
</tbody>
</table>
<p>For example, you can use the <code>HookDetector</code> to check if the user is explicitly
hooking the application with a specialized tool:</p>
<div class="codehilite"><pre><span></span><code>    <span class="c1">// Expected return value. You can pick any number,</span>
    <span class="c1">// to make the code less predictable.</span>
    <span class="kd">final</span> <span class="kt">int</span> <span class="n">OK</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Let the DexGuard runtime library detect whether the application is being</span>
    <span class="c1">// hooked.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">HookDetector</span><span class="p">.</span><span class="na">isApplicationHooked</span><span class="p">(</span><span class="n">OK</span><span class="p">)</span> <span class="o">!=</span> <span class="n">OK</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// The application is being hooked.</span>
       <span class="c1">// ...</span>
    <span class="p">}</span>
</code></pre></div>

<p>The check returns the value of the optional integer argument OK (default=0) if
the application is not being hooked. You should implement a suitable reaction
in case the application is being hooked, for example send back a warning to
your server or stop the application.</p>
<h3 id="root-detector">Root detector<a class="headerlink" href="#root-detector" title="Permanent link">&para;</a></h3>
<p>The original root detection method <code>RootDetector.isDeviceRooted()</code>, which returns
an integer value as described above, has been deprecated.</p>
<p>The preferred way to manually perform root detection is by using 
<code>RootDetector.checkDeviceRooted()</code> instead, as presented in the following code:</p>
<div class="tabbed-set" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Java 8</label><div class="tabbed-content">
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">com.guardsquare.dexguard.runtime.detection.RootDetector</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.guardsquare.dexguard.runtime.report.RootDetectorReport</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">bar</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// This is the location where you want to manually check for rooted devices.</span>
        <span class="c1">// context is the android.content.Context used to perform root detection.</span>
        <span class="n">RootDetector</span><span class="p">.</span><span class="na">checkDeviceRooted</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">Foo</span><span class="p">::</span><span class="n">rootDetectionCallback</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * The callback to execute when the root check completes. The device </span>
<span class="cm">     * is rooted when okValue != returnValue.</span>
<span class="cm">     *</span>
<span class="cm">     * @param okValue     the OK value provided to checkDeviceRooted().</span>
<span class="cm">     * @param returnValue the value computed by the root detector.</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">rootDetectionCallback</span><span class="p">(</span><span class="kt">int</span> <span class="n">okValue</span><span class="p">,</span> <span class="kt">int</span> <span class="n">returnValue</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span>  <span class="p">(</span> <span class="n">okValue</span> <span class="o">!=</span> <span class="n">returnValue</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Device is rooted, execute specific code.</span>
            <span class="p">...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The callback will be called as soon as root detection has completed. The device has been detected rooted 
when the <code>okValue</code> is different from the <code>returnValue</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For compatibility reasons with automatic RASP injection, the callback method should be defined as static.</p>
</div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">Kotlin</label><div class="tabbed-content">
<div class="codehilite"><pre><span></span><code><span class="k">import</span> <span class="nn">com.guardsquare.dexguard.runtime.detection.RootDetector</span>
<span class="k">import</span> <span class="nn">com.guardsquare.dexguard.runtime.report.RootDetectorReport</span>

<span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">bar</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// This is the location where you want to manually check for rooted devices.</span>
        <span class="c1">// context is the android.content.Context used to perform root detection.</span>
        <span class="n">RootDetector</span><span class="p">.</span><span class="n">checkDeviceRooted</span><span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="p">{</span> <span class="n">okValue</span><span class="p">,</span> <span class="n">returnValue</span> <span class="p">-&gt;</span> <span class="n">callback</span><span class="p">(</span><span class="n">okValue</span><span class="p">,</span> <span class="n">returnValue</span><span class="p">)</span> <span class="p">}</span>

    <span class="p">}</span>

    <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
        <span class="n">@JvmStatic</span>
        <span class="k">fun</span> <span class="nf">callback</span><span class="p">(</span><span class="n">okValue</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">returnValue</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">okValue</span> <span class="p">!=</span> <span class="n">returnValue</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">// Device is rooted, execute specific code.</span>
                <span class="p">...</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The callback will be called as soon as root detection has completed. The device has been detected rooted 
when the <code>okValue</code> is different from the <code>returnValue</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For compatibility reasons with automatic RASP injection, the callback function should be defined 
in the <code>companion object</code>, and marked as <code>@JvmStatic</code>.</p>
</div>
</div>
<input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><label for="__tabbed_2_3">Java 7 and earlier</label><div class="tabbed-content">
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">com.guardsquare.dexguard.runtime.detection.RootDetector</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">com.guardsquare.dexguard.runtime.report.RootDetectorReport</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Foo</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">bar</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// This is the location where you want to manually check for rooted devices.</span>
        <span class="c1">// context is the android.content.Context used to perform root detection.</span>
        <span class="n">RootDetector</span><span class="p">.</span><span class="na">checkDeviceRooted</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="k">new</span> <span class="n">RootDetector</span><span class="p">.</span><span class="na">Callback</span><span class="p">()</span> <span class="p">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onRootDetectionResultReceived</span><span class="p">(</span><span class="kt">int</span> <span class="n">okValue</span><span class="p">,</span> <span class="kt">int</span> <span class="n">returnValue</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">rootDetectionCallback</span><span class="p">(</span><span class="n">okValue</span><span class="p">,</span> <span class="n">returnValue</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="cm">/**</span>
<span class="cm">     * The callback to execute when the root check completes. The device </span>
<span class="cm">     * is rooted when okValue != returnValue.</span>
<span class="cm">     *</span>
<span class="cm">     * @param okValue     the OK value provided to checkDeviceRooted().</span>
<span class="cm">     * @param returnValue the value computed by the root detector.</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">rootDetectionCallback</span><span class="p">(</span><span class="kt">int</span> <span class="n">okValue</span><span class="p">,</span> <span class="kt">int</span> <span class="n">returnValue</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span>  <span class="p">(</span> <span class="n">okValue</span> <span class="o">!=</span> <span class="n">returnValue</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Device is rooted, execute specific code.</span>
            <span class="p">...</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>The callback will be called as soon as root detection has completed. The device has been detected rooted 
when the <code>okValue</code> is different from the <code>returnValue</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For compatibility reasons with automatic RASP injection, the code in the anonymous class used as callback 
should only call a static method which performs the actions when the device is detected as rooted.</p>
</div>
</div>
</div>
<h3 id="limitations_1">Limitations<a class="headerlink" href="#limitations_1" title="Permanent link">&para;</a></h3>
<p>Notably the root detector may return <strong>false positives</strong>, wrongly indicating
that a device is rooted, for example. This sometimes happens if vendors
install files on their factory images that are generally only present on
rooted devices.</p>
<p>The root detector may also return <strong>false negatives</strong>, missing rooted devices.
This may happen if users have installed recent, unknown root-hiding
frameworks.</p>
<p>We update detectors on a regular basis to account for new developments and to
improve the detection results. If you encounter a case where the runtime
library wrongly flags a device as being rooted, or did not correctly detect a
device as being rooted, please contact our <a href="mailto:support@guardsquare.com">technical
support</a> with any available details.</p>
<h3 id="environment-checks-performance">Environment Checks Performance<a class="headerlink" href="#environment-checks-performance" title="Permanent link">&para;</a></h3>
<p>The following table provides an impression of the overhead of the environment checks. It shows the execution times in
milliseconds for the API calls on a number of common devices.</p>
<p>Some of the runtime checks are one-time checks. You should use these checks once at the start of the application. However,
other runtime checks need to be called multiple times at appropriate places. You should use these checks at multiple
places in the code, specifically before performing a security sensitive activity (cfr. column "One-time" in the following
table).</p>
<table>
<thead>
<tr>
<th>API</th>
<th>One-time</th>
<th>Samsung S8+</th>
<th>Pixel 2</th>
<th>Nexus 6P</th>
<th>Samsung S8</th>
<th>Nubia NX591J</th>
<th>Google Nexus 5X</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td>-</td>
<td>Android 9</td>
<td>Android Q</td>
<td>Android 8</td>
<td>Android 8</td>
<td>Android 7.1.1</td>
<td>Android 6.0.1</td>
</tr>
<tr>
<td>isDebuggable</td>
<td>Yes</td>
<td>51</td>
<td>32</td>
<td>106</td>
<td>60</td>
<td>50</td>
<td>51</td>
</tr>
<tr>
<td>isDebuggerConnected</td>
<td>No</td>
<td>1</td>
<td>1</td>
<td>15</td>
<td>2</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>isSignedWithDebugKey</td>
<td>Yes</td>
<td>&lt;1</td>
<td>2</td>
<td>10</td>
<td>5</td>
<td>7</td>
<td>6</td>
</tr>
<tr>
<td>isRunningInEmulator</td>
<td>Yes</td>
<td>5</td>
<td>2</td>
<td>23</td>
<td>2</td>
<td>2</td>
<td>&lt;1</td>
</tr>
<tr>
<td>isDeviceRooted</td>
<td>Yes</td>
<td>170</td>
<td>95</td>
<td>13 (Root)</td>
<td>2 (Root)</td>
<td>900</td>
<td>1 (Root)</td>
</tr>
<tr>
<td>isApplicationHooked</td>
<td>No</td>
<td>500</td>
<td>316</td>
<td>690</td>
<td>335</td>
<td>140</td>
<td>125</td>
</tr>
<tr>
<td>isApplicationHooked - FAST</td>
<td>No</td>
<td>132</td>
<td>91</td>
<td>257</td>
<td>98</td>
<td>80</td>
<td>82</td>
</tr>
<tr>
<td>isRunningInVirtualEnvironment</td>
<td>Yes</td>
<td>1139</td>
<td>121</td>
<td>523</td>
<td>1500</td>
<td>510</td>
<td>230</td>
</tr>
</tbody>
</table>
<p>You can see that the <code>HookDetector.isApplicationHooked</code> is considerably faster with the <code>FAST</code> flag. The HookDetector does
not skip any checks with the <code>FAST</code> flag. However, for faster hook detection, it only considers hooking mechanisms found
in known hooking tools.</p>
<h2 id="debugger-blocking">Debugger blocking<a class="headerlink" href="#debugger-blocking" title="Permanent link">&para;</a></h2>
<p>The runtime library provides an API <code>DebugBlocker.blockDebugger</code> (in
package <a href="runtime/com/guardsquare/dexguard/runtime/detection/package-summary.html">com.guardsquare.dexguard.runtime.detection</a>)
to block native debuggers (not traditional Java debuggers, which are based on a
different mechanism). You can implement its interface <code>OnAttackListener</code> and
method <code>onAttack()</code> as a callback method in case the debug blocker is attacked.
You need to provide an instance of your listener to the <code>DebugBlocker.blockDebugger</code> API.
Follow the two step process to use debug blocker:</p>
<p>Create a class that implements the DebugBlocker.OnAttackListener interface to provide a callback method.</p>
<div class="codehilite"><pre><span></span><code><span class="kd">class</span> <span class="nc">AttackHandlerExample</span> <span class="kd">implements</span> <span class="n">DebugBlocker</span><span class="p">.</span><span class="na">OnAttackListener</span>
<span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onAttack</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// Here you should implement the expected app behavior in case of an attack on the DebugBlocker.</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Provide an instance of the AttackHandlerExample class to <code>DebugBlocker.blockDebugger</code>.</p>
<div class="codehilite"><pre><span></span><code>    <span class="kt">int</span> <span class="n">isDebuggerBlocked</span> <span class="o">=</span> <span class="n">DebugBlocker</span><span class="p">.</span><span class="na">blockDebugger</span><span class="p">(</span><span class="k">new</span> <span class="n">AttackHandlerExample</span><span class="p">());</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">isDebuggerBlocked</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Debug blocker wasn&#39;t successful. You can further check the reason of failure.</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">isDebuggerBlocked</span> <span class="o">&amp;</span> <span class="n">DebugBlocker</span><span class="p">.</span><span class="na">DEBUGGER_CONNECTED</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// A debugger is already connected to the application. The application should exit.</span>
            <span class="c1">// ...</span>
        <span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>

<p>Please refer to the sample project in the directory <code>sample/basic/DebugBlocker</code> for an example implementation
of the debug blocker.</p>
<h2 id="webview-asset-encryption">Asset encryption for WebView clients<a class="headerlink" href="#webview-asset-encryption" title="Permanent link">&para;</a></h2>
<p>You can encrypt the asset files (javascript, html, css,...) that are included
in Cordova applications or applications with a WebView. Please refer to the
package
<a href="runtime/com/guardsquare/dexguard/runtime/encryption/package-summary.html">com.guardsquare.dexguard.runtime.encryption</a>
and to the sample projects in the directories <code>samples/basic/Cordova</code> and
<code>samples/basic/WebView</code>.</p>
<h2 id="ssl-pinning">SSL pinning<a class="headerlink" href="#ssl-pinning" title="Permanent link">&para;</a></h2>
<p>Several modern network libraries like OkHttp already support SSL pinning. The
DexGuard runtime library provides some support classes to implement SSL
pinning techniques with some older commonly used libraries:</p>
<ul>
<li>org.apache.http.client (certificate pinning),</li>
<li>javax.net.ssl (certificate pinning),</li>
<li>javax.net.ssl (public key pinning).</li>
</ul>
<p>Additionally, the support classes are hardened against commonly known hooking attacks,
making SSL pinning solutions more robust.</p>
<p>You can find the support classes in package
<a href="runtime/com/guardsquare/dexguard/runtime/net/package-summary.html">com.guardsquare.dexguard.runtime.net</a>.</p>
<p>The distribution also includes a command line tool to extract the public key
hashes from a server certificate (<code>bin/hash_certificate.[sh,bat]</code>).</p>
<p>For example, you can enable public key pinning for an <code>HttpsURLConnection</code>:</p>
<div class="codehilite"><pre><span></span><code>    <span class="c1">// Create a TrustManager that only accepts servers with the specified public key hashes.</span>
    <span class="c1">// This code snippet can be generated by the hash_certificate tool for a given url.</span>
    <span class="c1">// In this example we use the Wikipedia certificate for illustration purposes.</span>
    <span class="n">com</span><span class="p">.</span><span class="na">guardsquare</span><span class="p">.</span><span class="na">dexguard</span><span class="p">.</span><span class="na">runtime</span><span class="p">.</span><span class="na">net</span><span class="p">.</span><span class="na">PublicKeyTrustManager</span> <span class="n">trustManager</span> <span class="o">=</span>
        <span class="k">new</span> <span class="n">com</span><span class="p">.</span><span class="na">guardsquare</span><span class="p">.</span><span class="na">dexguard</span><span class="p">.</span><span class="na">runtime</span><span class="p">.</span><span class="na">net</span><span class="p">.</span><span class="na">PublicKeyTrustManager</span><span class="p">(</span>
            <span class="k">new</span> <span class="n">String</span><span class="o">[]</span> <span class="p">{</span>
                <span class="c1">// CN=*.wikipedia.org, O=&quot;Wikimedia Foundation, Inc.&quot;, L=San Francisco, ST=California, C=US</span>
                <span class="s">&quot;8FCF8FD90E88D6E35BA8CB6D8836A2BF&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">);</span>

    <span class="n">SSLPinner</span> <span class="n">sslPinner</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SSLPinner</span><span class="p">(</span><span class="n">trustManager</span><span class="p">);</span>

    <span class="c1">// ...</span>

    <span class="c1">// Create the URL connection.</span>
    <span class="n">URL</span> <span class="n">url</span> <span class="o">=</span> <span class="k">new</span> <span class="n">URL</span><span class="p">(</span><span class="n">urlString</span><span class="p">);</span>
    <span class="n">HttpsURLConnection</span> <span class="n">urlConnection</span> <span class="o">=</span> <span class="p">(</span><span class="n">HttpsURLConnection</span><span class="p">)</span><span class="n">url</span><span class="p">.</span><span class="na">openConnection</span><span class="p">();</span>
    <span class="n">sslPinner</span><span class="p">.</span><span class="na">pinHttpsURLConnection</span><span class="p">(</span><span class="n">urlConnection</span><span class="p">);</span>
</code></pre></div>

<p>Please refer to the additional examples in the directories
<code>samples/basic/SSLPinning</code> and <code>samples/basic/SSLPinningWebView</code>. These
projects also illustrate how to harden the SSL pinning code further with
DexGuard.</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="verification.html" title="Verification" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Verification
              </span>
            </div>
          </a>
        
        
          <a href="plugins.html" title="Encryption Plugins" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Encryption Plugins
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Guardsquare
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="assets/fonts/font-awesome.css">
    
      <a href="https://twitter.com/guardsquare" target="_blank" rel="noopener" title="twitter" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/guardsquare-nv" target="_blank" rel="noopener" title="linkedin" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://www.facebook.com/guardsquare" target="_blank" rel="noopener" title="facebook" class="md-footer-social__link fa fa-facebook"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>